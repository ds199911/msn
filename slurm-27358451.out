INFO:root:loaded params...
{   'data': {'image_folder': '/imagenet/', 'num_classes': 25, 'root_path': '.'},
    'logging': {   'folder': './checkpoint/msn_ehr_logs/',
                   'pretrain_path': '/scratch/projects/shamoutlab/ds5749/multi-modal-msn/checkpoint/msn_ehr_logs/msn-ehr-experiment-vertical_and_horizontal-ep100.pth.tar',
                   'write_tag': 'msn-lineval-experiment-ehr'},
    'meta': {   'copy_data': False,
                'device': 'cuda:0',
                'load_checkpoint': True,
                'master_port': 8888,
                'model_name': 'LSTM',
                'training': True},
    'optimization': {   'epochs': 100,
                        'lr': 6.4,
                        'normalize': True,
                        'num_blocks': 1,
                        'weight_decay': 0.0}}
INFO:root:Running linear-evaluation
INFO:root:MIMICCXR ehr fusion dataset
INFO:root:Namespace(align=0.0, batch_size=64, beta_1=0.9, crop=224, cxr_data_dir='/data/MedFuse/2.0.0', daft_activation='linear', data_pairs='partial_ehr_cxr', data_ratio=1.0, depth=1, dim=256, dropout=0.0, ehr_data_dir='/data/MedFuse/mimic-iv-extracted', epochs=100, eval=False, fname='configs/eval/medfuse_ehr.yaml', fusion='joint', fusion_type='lstm', imputation='previous', labels_set='pheno', layer_after=4, layers=1, load_state=None, load_state_cxr=None, load_state_ehr=None, lr=0.0001, missing_token=None, mmtm_ratio=4, modality='ehr', mode='train', network=None, normalizer_state='/scratch/projects/shamoutlab/ds5749/multi-modal-msn/src/medfuse/normalizers/ph_ts1.0.input_str:previous.start_time:zero.normalizer', num_classes=25, patience=15, pretrained=False, rec_dropout=0.0, resize=256, resume=False, save_dir='checkpoints', task='phenotyping', timestep=1.0, vision_backbone='densenet121', vision_num_classes=14)
INFO:root:partial_ehr_cxrlstm
INFO:root:MIMICCXR dataset created
INFO:root:unsupervised data loader created
INFO:root:MIMICCXR ehr fusion dataset
INFO:root:Namespace(align=0.0, batch_size=64, beta_1=0.9, crop=224, cxr_data_dir='/data/MedFuse/2.0.0', daft_activation='linear', data_pairs='partial_ehr_cxr', data_ratio=1.0, depth=1, dim=256, dropout=0.0, ehr_data_dir='/data/MedFuse/mimic-iv-extracted', epochs=100, eval=False, fname='configs/eval/medfuse_ehr.yaml', fusion='joint', fusion_type='lstm', imputation='previous', labels_set='pheno', layer_after=4, layers=1, load_state=None, load_state_cxr=None, load_state_ehr=None, lr=0.0001, missing_token=None, mmtm_ratio=4, modality='ehr', mode='train', network=None, normalizer_state='/scratch/projects/shamoutlab/ds5749/multi-modal-msn/src/medfuse/normalizers/ph_ts1.0.input_str:previous.start_time:zero.normalizer', num_classes=25, patience=15, pretrained=False, rec_dropout=0.0, resize=256, resume=False, save_dir='checkpoints', task='phenotyping', timestep=1.0, vision_backbone='densenet121', vision_num_classes=14)
INFO:root:partial_ehr_cxrlstm
INFO:root:MIMICCXR dataset created
INFO:root:unsupervised data loader created
INFO:root:initialized data-loader (ipe 333)
INFO:root:initialized val data-loader (ipe 37)
INFO:root:key "LayerNorm.weight" could not be found in loaded state dict
INFO:root:key "LayerNorm.bias" could not be found in loaded state dict
INFO:root:loaded pretrained model with msg: _IncompatibleKeys(missing_keys=['LayerNorm.weight', 'LayerNorm.bias'], unexpected_keys=['fc.fc1.weight', 'fc.fc1.bias', 'fc.bn1.weight', 'fc.bn1.bias', 'fc.bn1.running_mean', 'fc.bn1.running_var', 'fc.bn1.num_batches_tracked', 'fc.fc2.weight', 'fc.fc2.bias', 'fc.bn2.weight', 'fc.bn2.bias', 'fc.bn2.running_mean', 'fc.bn2.running_var', 'fc.bn2.num_batches_tracked', 'fc.fc3.weight', 'fc.fc3.bias'])
INFO:root:loaded pretrained encoder from epoch: 99 path: /scratch/projects/shamoutlab/ds5749/multi-modal-msn/checkpoint/msn_ehr_logs/msn-ehr-experiment-vertical_and_horizontal-ep100.pth.tar
INFO:root:LSTM(
  (layer0): LSTM(76, 128, batch_first=True)
  (dense_layer): Linear(in_features=128, out_features=128, bias=True)
  (LayerNorm): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
)
INFO:root:putting model in eval mode
INFO:root:122240
INFO:root:epoch: 0
INFO:root:epoch: 1
INFO:root:epoch: 2
INFO:root:epoch: 3
INFO:root:epoch: 4
INFO:root:epoch: 5
INFO:root:epoch: 6
INFO:root:epoch: 7
INFO:root:epoch: 8
INFO:root:epoch: 9
INFO:root:epoch: 10
INFO:root:epoch: 11
INFO:root:epoch: 12
INFO:root:epoch: 13
INFO:root:epoch: 14
INFO:root:epoch: 15
INFO:root:epoch: 16
INFO:root:epoch: 17
INFO:root:epoch: 18
INFO:root:epoch: 19
INFO:root:epoch: 20
INFO:root:epoch: 21
INFO:root:epoch: 22
INFO:root:epoch: 23
INFO:root:epoch: 24
INFO:root:epoch: 25
INFO:root:epoch: 26
INFO:root:epoch: 27
INFO:root:epoch: 28
INFO:root:epoch: 29
INFO:root:epoch: 30
INFO:root:epoch: 31
INFO:root:epoch: 32
INFO:root:epoch: 33
INFO:root:epoch: 34
INFO:root:epoch: 35
INFO:root:epoch: 36
INFO:root:epoch: 37
INFO:root:epoch: 38
INFO:root:epoch: 39
INFO:root:epoch: 40
INFO:root:epoch: 41
INFO:root:epoch: 42
INFO:root:epoch: 43
INFO:root:epoch: 44
INFO:root:epoch: 45
INFO:root:epoch: 46
INFO:root:epoch: 47
INFO:root:epoch: 48
INFO:root:epoch: 49
INFO:root:epoch: 50
INFO:root:epoch: 51
INFO:root:epoch: 52
INFO:root:epoch: 53
INFO:root:epoch: 54
INFO:root:epoch: 55
INFO:root:epoch: 56
INFO:root:epoch: 57
INFO:root:epoch: 58
INFO:root:epoch: 59
INFO:root:epoch: 60
INFO:root:epoch: 61
INFO:root:epoch: 62
INFO:root:epoch: 63
INFO:root:epoch: 64
INFO:root:epoch: 65
INFO:root:epoch: 66
INFO:root:epoch: 67
INFO:root:epoch: 68
INFO:root:epoch: 69
INFO:root:epoch: 70
INFO:root:epoch: 71
INFO:root:epoch: 72
INFO:root:epoch: 73
INFO:root:epoch: 74
INFO:root:epoch: 75
INFO:root:epoch: 76
INFO:root:epoch: 77
INFO:root:epoch: 78
INFO:root:epoch: 79
INFO:root:epoch: 80
INFO:root:epoch: 81
INFO:root:epoch: 82
INFO:root:epoch: 83
INFO:root:epoch: 84
INFO:root:epoch: 85
INFO:root:epoch: 86
INFO:root:epoch: 87
INFO:root:epoch: 88
INFO:root:epoch: 89
INFO:root:epoch: 90
INFO:root:epoch: 91
INFO:root:epoch: 92
INFO:root:epoch: 93
INFO:root:epoch: 94
INFO:root:epoch: 95
INFO:root:epoch: 96
INFO:root:epoch: 97
INFO:root:epoch: 98
INFO:root:epoch: 99
INFO:root:epoch: 100
INFO:root:epoch: 101
INFO:root:epoch: 102
INFO:root:epoch: 103
INFO:root:epoch: 104
INFO:root:epoch: 105
INFO:root:epoch: 106
INFO:root:epoch: 107
INFO:root:epoch: 108
INFO:root:epoch: 109
INFO:root:epoch: 110
INFO:root:epoch: 111
INFO:root:epoch: 112
INFO:root:epoch: 113
INFO:root:epoch: 114
INFO:root:epoch: 115
INFO:root:epoch: 116
INFO:root:epoch: 117
INFO:root:epoch: 118
INFO:root:epoch: 119
INFO:root:epoch: 120
INFO:root:epoch: 121
INFO:root:epoch: 122
INFO:root:epoch: 123
INFO:root:epoch: 124
INFO:root:epoch: 125
INFO:root:epoch: 126
INFO:root:epoch: 127
INFO:root:epoch: 128
INFO:root:epoch: 129
INFO:root:epoch: 130
INFO:root:epoch: 131
INFO:root:epoch: 132
INFO:root:epoch: 133
INFO:root:epoch: 134
INFO:root:epoch: 135
INFO:root:epoch: 136
INFO:root:epoch: 137
INFO:root:epoch: 138
INFO:root:epoch: 139
INFO:root:epoch: 140
INFO:root:epoch: 141
INFO:root:epoch: 142
INFO:root:epoch: 143
INFO:root:epoch: 144
INFO:root:epoch: 145
INFO:root:epoch: 146
INFO:root:epoch: 147
INFO:root:epoch: 148
INFO:root:epoch: 149
INFO:root:epoch: 150
INFO:root:epoch: 151
INFO:root:epoch: 152
INFO:root:epoch: 153
INFO:root:epoch: 154
INFO:root:epoch: 155
INFO:root:epoch: 156
INFO:root:epoch: 157
INFO:root:epoch: 158
INFO:root:epoch: 159
INFO:root:epoch: 160
INFO:root:epoch: 161
INFO:root:epoch: 162
INFO:root:epoch: 163
INFO:root:epoch: 164
INFO:root:epoch: 165
INFO:root:epoch: 166
INFO:root:epoch: 167
INFO:root:epoch: 168
INFO:root:epoch: 169
INFO:root:epoch: 170
INFO:root:epoch: 171
INFO:root:epoch: 172
INFO:root:epoch: 173
INFO:root:epoch: 174
INFO:root:epoch: 175
INFO:root:epoch: 176
INFO:root:epoch: 177
INFO:root:epoch: 178
INFO:root:epoch: 179
INFO:root:epoch: 180
INFO:root:epoch: 181
INFO:root:epoch: 182
INFO:root:epoch: 183
INFO:root:epoch: 184
INFO:root:epoch: 185
INFO:root:epoch: 186
INFO:root:epoch: 187
INFO:root:epoch: 188
INFO:root:epoch: 189
INFO:root:epoch: 190
INFO:root:epoch: 191
INFO:root:epoch: 192
INFO:root:epoch: 193
INFO:root:epoch: 194
INFO:root:epoch: 195
INFO:root:epoch: 196
INFO:root:epoch: 197
INFO:root:epoch: 198
INFO:root:epoch: 199
INFO:root:epoch: 200
INFO:root:epoch: 201
INFO:root:epoch: 202
INFO:root:epoch: 203
INFO:root:epoch: 204
INFO:root:epoch: 205
INFO:root:epoch: 206
INFO:root:epoch: 207
INFO:root:epoch: 208
INFO:root:epoch: 209
INFO:root:epoch: 210
INFO:root:epoch: 211
INFO:root:epoch: 212
INFO:root:epoch: 213
INFO:root:epoch: 214
INFO:root:epoch: 215
INFO:root:epoch: 216
INFO:root:epoch: 217
INFO:root:epoch: 218
INFO:root:epoch: 219
INFO:root:epoch: 220
INFO:root:epoch: 221
INFO:root:epoch: 222
INFO:root:epoch: 223
INFO:root:epoch: 224
INFO:root:epoch: 225
INFO:root:epoch: 226
INFO:root:epoch: 227
INFO:root:epoch: 228
INFO:root:epoch: 229
INFO:root:epoch: 230
INFO:root:epoch: 231
INFO:root:epoch: 232
INFO:root:epoch: 233
INFO:root:epoch: 234
INFO:root:epoch: 235
INFO:root:epoch: 236
INFO:root:epoch: 237
INFO:root:epoch: 238
INFO:root:epoch: 239
INFO:root:epoch: 240
INFO:root:epoch: 241
INFO:root:epoch: 242
INFO:root:epoch: 243
INFO:root:epoch: 244
INFO:root:epoch: 245
INFO:root:epoch: 246
INFO:root:epoch: 247
INFO:root:epoch: 248
INFO:root:epoch: 249
INFO:root:epoch: 250
INFO:root:epoch: 251
INFO:root:epoch: 252
INFO:root:epoch: 253
INFO:root:epoch: 254
INFO:root:epoch: 255
INFO:root:epoch: 256
INFO:root:epoch: 257
INFO:root:epoch: 258
INFO:root:epoch: 259
INFO:root:epoch: 260
INFO:root:epoch: 261
INFO:root:epoch: 262
INFO:root:epoch: 263
INFO:root:epoch: 264
INFO:root:epoch: 265
INFO:root:epoch: 266
INFO:root:epoch: 267
INFO:root:epoch: 268
INFO:root:epoch: 269
INFO:root:epoch: 270
INFO:root:epoch: 271
INFO:root:epoch: 272
INFO:root:epoch: 273
INFO:root:epoch: 274
INFO:root:epoch: 275
INFO:root:epoch: 276
INFO:root:epoch: 277
INFO:root:epoch: 278
INFO:root:epoch: 279
INFO:root:epoch: 280
INFO:root:epoch: 281
INFO:root:epoch: 282
INFO:root:epoch: 283
INFO:root:epoch: 284
INFO:root:epoch: 285
INFO:root:epoch: 286
INFO:root:epoch: 287
INFO:root:epoch: 288
INFO:root:epoch: 289
INFO:root:epoch: 290
INFO:root:epoch: 291
INFO:root:epoch: 292
INFO:root:epoch: 293
INFO:root:epoch: 294
INFO:root:epoch: 295
INFO:root:epoch: 296
INFO:root:epoch: 297
INFO:root:epoch: 298
INFO:root:epoch: 299
INFO:root:epoch: 300
INFO:root:epoch: 301
INFO:root:epoch: 302
INFO:root:epoch: 303
INFO:root:epoch: 304
INFO:root:epoch: 305
INFO:root:epoch: 306
INFO:root:epoch: 307
INFO:root:epoch: 308
INFO:root:epoch: 309
INFO:root:epoch: 310
INFO:root:epoch: 311
INFO:root:epoch: 312
INFO:root:epoch: 313
INFO:root:epoch: 314
INFO:root:epoch: 315
INFO:root:epoch: 316
INFO:root:epoch: 317
INFO:root:epoch: 318
INFO:root:epoch: 319
INFO:root:epoch: 320
INFO:root:epoch: 321
INFO:root:epoch: 322
INFO:root:epoch: 323
INFO:root:epoch: 324
INFO:root:epoch: 325
INFO:root:epoch: 326
INFO:root:epoch: 327
INFO:root:epoch: 328
INFO:root:epoch: 329
INFO:root:epoch: 330
INFO:root:epoch: 331
INFO:root:epoch: 332
INFO:root:train metrics
INFO:root:auc_scores
INFO:root:[0.54777157 0.65080916 0.51807869 0.50951295 0.50862253 0.51318423
 0.52708262 0.50984876 0.53018033 0.52217426 0.50443781 0.51238263
 0.51064252 0.51697586 0.54824994 0.52711219 0.50431474 0.52625915
 0.50675415 0.54150828 0.53669104 0.55480832 0.60356402 0.56477861
 0.61035609]
INFO:root:auroc_mean
INFO:root:0.5362440169803298
INFO:root:auprc_mean
INFO:root:0.20400464414845884
INFO:root:auprc_scores
INFO:root:[0.30323413 0.11272299 0.08015476 0.33152823 0.21045113 0.14821433
 0.20491585 0.1021678  0.27525466 0.32828832 0.11613025 0.17902343
 0.41282528 0.42982253 0.40824557 0.07730791 0.21835234 0.13815184
 0.09829688 0.05768782 0.0760233  0.15185219 0.23931603 0.19873955
 0.20140897]
INFO:root:ci_auroc
INFO:root:[(0.5411419233803944, 0.5540091808995846), (0.6376137219206874, 0.6631204307939438), (0.5069553443629131, 0.5290078126911547), (0.5041835850834004, 0.5153981163047772), (0.5016328877530568, 0.5159334465105058), (0.5055668658872524, 0.5207520537726795), (0.5196684179165718, 0.5342663352027616), (0.5005994654637206, 0.5189977234942246), (0.5238964811002496, 0.5365543471291269), (0.5159235452740273, 0.5283432112917721), (0.49581693789883946, 0.5126489003676018), (0.5055618005303786, 0.5194691694924628), (0.5051332697183942, 0.5164595100032993), (0.5111934768491104, 0.5220123521723817), (0.5424722425645759, 0.5536182152862485), (0.5155323196607804, 0.537894981221012), (0.49713376014664634, 0.5113064186729851), (0.5175692026531585, 0.5350683121616439), (0.49720203231447024, 0.5162379530206108), (0.5276442294031435, 0.5551972316387174), (0.5253610839099041, 0.547570188629959), (0.5460666843543888, 0.5642860962431624), (0.5952906492666972, 0.6117116467893348), (0.5568474654763406, 0.572609036295394), (0.6014246762567136, 0.6195236119541028)]
INFO:root:ci_auprc
INFO:root:[(0.2964136136452334, 0.3102666525228397), (0.10587150890693725, 0.12088369131966666), (0.07659696024090927, 0.0845267182207391), (0.3254317054100446, 0.3380460500986626), (0.20520739199009136, 0.2164526057014883), (0.14376674186688312, 0.15322269573215455), (0.19927504527274845, 0.2111961085278093), (0.09847973779368428, 0.10672637061825196), (0.26939695487333387, 0.2818795657724074), (0.3215354386243291, 0.33524718742917387), (0.11195754905410024, 0.12083395833709658), (0.17391081950616957, 0.18463520717880222), (0.4069104628019356, 0.4195233781787157), (0.4235311533819144, 0.4366750184694035), (0.4013999854925935, 0.4154282250576898), (0.07369445942951341, 0.08145191323888838), (0.21302675125773085, 0.22432233713924646), (0.13333414772740604, 0.14359916483529267), (0.09447335851854582, 0.10281995663954667), (0.054119493346442296, 0.06202632019958016), (0.07214861320607897, 0.08043671607538448), (0.14696183736233348, 0.15783757867010287), (0.23099143865425342, 0.24803708542214312), (0.19208128044647566, 0.20564591103081298), (0.19319831998955161, 0.21088155630304867)]
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
[W pthreadpool-cpp.cc:90] Warning: Leaking Caffe2 thread-pool after fork. (function pthreadpool)
INFO:root:val epoch: 0
INFO:root:val epoch: 1
INFO:root:val epoch: 2
INFO:root:val epoch: 3
INFO:root:val epoch: 4
INFO:root:val epoch: 5
INFO:root:val epoch: 6
INFO:root:val epoch: 7
INFO:root:val epoch: 8
INFO:root:val epoch: 9
INFO:root:val epoch: 10
INFO:root:val epoch: 11
INFO:root:val epoch: 12
INFO:root:val epoch: 13
INFO:root:val epoch: 14
INFO:root:val epoch: 15
INFO:root:val epoch: 16
INFO:root:val epoch: 17
INFO:root:val epoch: 18
INFO:root:val epoch: 19
INFO:root:val epoch: 20
INFO:root:val epoch: 21
INFO:root:val epoch: 22
INFO:root:val epoch: 23
INFO:root:val epoch: 24
INFO:root:val epoch: 25
INFO:root:val epoch: 26
INFO:root:val epoch: 27
INFO:root:val epoch: 28
INFO:root:val epoch: 29
INFO:root:val epoch: 30
INFO:root:val epoch: 31
INFO:root:val epoch: 32
INFO:root:val epoch: 33
INFO:root:val epoch: 34
INFO:root:val epoch: 35
INFO:root:val epoch: 36
INFO:root:val metrics
INFO:root:auc_scores
INFO:root:[0.63666493 0.76271284 0.59413138 0.5777689  0.58358898 0.56995422
 0.61300984 0.57906124 0.61568723 0.6060474  0.57583386 0.56434821
 0.58061876 0.54383271 0.62879214 0.5885386  0.58102197 0.6116829
 0.54169068 0.5996152  0.62046549 0.66279955 0.71162492 0.68837463
 0.72758049]
INFO:root:auroc_mean
INFO:root:0.6146178823918099
INFO:root:auprc_mean
INFO:root:0.2534184238024807
INFO:root:auprc_scores
INFO:root:[0.37918369 0.16170673 0.09945544 0.35659881 0.2434125  0.17408412
 0.25706425 0.13043131 0.336331   0.40404989 0.1580649  0.20397977
 0.47190612 0.45031227 0.49091748 0.08591581 0.2591921  0.1897992
 0.11265641 0.09073572 0.09718561 0.21502141 0.34496171 0.292086
 0.33040835]
INFO:root:ci_auroc
INFO:root:[(0.6168090982898339, 0.6538941705303678), (0.7279328809569716, 0.7960726404978792), (0.5632008984729748, 0.6221077672707737), (0.5616218879338647, 0.5960462745996424), (0.5647973252684088, 0.6027184039541309), (0.5490623574914413, 0.592783460367763), (0.592710210000995, 0.6313391421056755), (0.5515791773426524, 0.6050684715035748), (0.5979278076840697, 0.6316797806679206), (0.5895739173719046, 0.6231222066086829), (0.5526367028007316, 0.6007063919149168), (0.5417883004130386, 0.5860708719749322), (0.5634519134682107, 0.5961625857739142), (0.5267525505974366, 0.5616912152958008), (0.6119913969570042, 0.6443122642151086), (0.5588340657309303, 0.6167728870633059), (0.5623586125802766, 0.6014006881434146), (0.5885548861069058, 0.6356002919614074), (0.5152721279927668, 0.5691560119873204), (0.5639681806434783, 0.6327344904954855), (0.5894533422246283, 0.6505626147382576), (0.6410333046377568, 0.6848103497511402), (0.692417759872156, 0.732415487088113), (0.6692400788127241, 0.7081153455703053), (0.7069590321303018, 0.7484480315532598)]
INFO:root:ci_auprc
INFO:root:[(0.3550170541584938, 0.40775019622252534), (0.12991330987180577, 0.20462156081042848), (0.08693164108367697, 0.11681605647107904), (0.3375339137276142, 0.3788051637890018), (0.22649090067926536, 0.26158227268194734), (0.1595241346961629, 0.1937024384697468), (0.2369929650974388, 0.2804275117620338), (0.11530344959004642, 0.14970624589384451), (0.31333591030438446, 0.35934828324048784), (0.3826974674778929, 0.4308302665255501), (0.14123807801783628, 0.17946080444778165), (0.18683410916608592, 0.22386574515545882), (0.45056530898701397, 0.49482894671159594), (0.42908922748153744, 0.47238556447675367), (0.4681423127606723, 0.5152079760930783), (0.07459533325089793, 0.10454573078372251), (0.2434256714561651, 0.28020022597228994), (0.16644867978820177, 0.21707593699846717), (0.09962564498951279, 0.12917655497392055), (0.0741301500812491, 0.11615674484931951), (0.08364502891948522, 0.1176554630757615), (0.1923034583076217, 0.24401893339711567), (0.3153145630338966, 0.3810470658953848), (0.2653216254144742, 0.32466697600228495), (0.29155075733474045, 0.37174302510190815)]
mefuse_linear_eval.py:348: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  inputs, labels = torch.tensor(data[0]).to(device), torch.tensor(data[1]).to(device)
